{% extends 'admin.html' %}
{% load bootstrap %}
{% block seccion-contenido %}
<form method="POST" action="" enctype="multipart/form-data" >{% csrf_token %}

    <div class="panel panel-default">
        <div class="panel-heading">
            <h4>Nuevo Macrocliente</h4>
        </div>
        <div class="panel-heading">
            <div class="col-sm-6">
                 {{ formulario.submarca|bootstrap}}
            </div>
            <div class="col-sm-6">
                {{ formulario.nombre | bootstrap}}
            </div>
            <div class="col-sm-6">
                {{ formulario.telefono | bootstrap }}
            </div>
            <div class="col-sm-6">
                {{ formulario.rif | bootstrap }}
            </div>
            <div class="col-sm-12">
                {{ formulario.direccion_fiscal | bootstrap }}
            </div>
            <div class="col-sm-12">
                {{ formulario.descripcion | bootstrap }}

                <!--Empieza el mapaaaaaaaaaaaaaaaaaaaaa -->
                                <div class="main-column col-md-6">
                   <div id="adderess-list">
	                    <h4>Direcciones Actuales</h4>
	                    <div id="direccion"><!-- OJO no cambiar este id, lo usa una funcion -->
	                        {% for direccion in direcciones %}
	                            <div class='row form-group'>
	                                <input type='text' class='form-control' size =35 name='dir' value='{{direccion.direccion}}' readonly/>
                                    <input type="text" class='form-control' size=35 name='dir' value='{{ direccion.descripcion }}'readonly/>
	                                <input type='hidden' name='dir' value='{{direccion.lat|stringformat:"f"}}'/>
	                                <input type='hidden' name='dir' value='{{direccion.lon|stringformat:"f"}}'/>
	                                <a onclick='removeInput(this.parentNode)'>remove</a>
	                            </div>
	                            {% empty %}
	                                You have not address yet
	                        {% endfor %}
	                    </div>
	                    <div id="warning"></div><!-- OJO no cambiar este id, lo usa una funcion -->
                    </div>
                </div>


    <div class="col-sm-5">
        <h4>Seleccionar Direcciones</h4>
        <div class="row form-group form-section">
            <label class="col-sm-2 control-label">
                Buscar
            </label>
            <div class="col-sm-12">
            	    <div class="input-group">
				      <input type="text" class="form-control" id="address" size="29"/>
				      <span class="input-group-btn">
				        <input type="button" class="btn btn-default" value="Go" onclick="geocode()">
				      </span>
				    </div><!-- /input-group -->
            </div>
		    <label  class="control-label col-sm-3">Descripción</label>
			<div class="col-md-12" >
		        <input type="text" id="descripcion" class="form-control">
			</div>
            <div class="col-sm-12 col-sm-offset-4">
                <br>
		        <button type='button' class="btn btn-default" onclick="addInput()"><span class="glyphicon glyphicon-plus"></span> Agregar Dirección</button>
            </div>
            <div class="col-sm-12">
                <strong>Lat/Lng</strong>
            </div>
            <div class="col-sm-10" id="ll">
            </div>
            <div class="col-sm-12">
                <strong>Dirección</strong>
            </div>
            <div class="col-sm-10" id="fa">
            </div>
        </div>








        <div class="row form-group">

        </div>
        <div class="row form-group">

        </div>

        <div id="map">
            <div id="map_canvas" style="width:100%; height:320px"></div>
            <div id="crosshair"></div>
        </div>
        <input type="hidden" id="latlng">
        <input type="hidden" id="formatedAddress">
    </div>



                <!--termina el mapa -->
            </div>
            <input type="submit" class="btn btn-primary" value="guardar">
        </div>
    </div>
</form>
{% endblock %}

{% block js %}
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="{{STATIC_URL}}js/maps.js"></script>
    <script>

        function initialize() {
            var latlng = new google.maps.LatLng(34.0883632, -118.3788381);
            var myOptions = {
                zoom: 10,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

            createMarker(latlng);
        }

        fields = {{direcciones.count}};

        function addInput() {
          if (fields < 5) {
            var addr = document.getElementById('formatedAddress').value;
            var coord = document.getElementById('latlng').value;
            var desc = document.getElementById('descripcion').value;
            var yx = coord.split(",");
            document.getElementById('direccion').innerHTML +=
              "<div class='row form-group'><input type='text' class='form-control' size =35 name='dir' value='"+addr+"' readonly/>" +
              "<input type='text' class='form-control' name='dir' value='"+desc+"'readonly/>" +
              "<input type='hidden' name='dir' value='"+yx[0]+"'/>" +
              "<input type='hidden' name='dir' value='"+yx[1]+"'/>" +
              " <a onclick='removeInput(this.parentNode)' />remove</div>";
            fields += 1;
          } else {
            document.getElementById('warning').innerHTML =
              "Only 5 upload addresses allowed.";
            document.form.add.disabled = true;
          }
        }

        function removeInput( el ) {
          if (fields > 0) {
            document.getElementById('warning').innerHTML = "";
            var parent = document.getElementById('direccion');
            parent.removeChild(el);
            fields -= 1;
          }
        }

        function addLike(id){
          var x=document.getElementById("like").value;
          var string1 = "/add_like_edit/";
          window.location.assign(string1 + x + "-" + id)
        }

        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
{% endblock %}