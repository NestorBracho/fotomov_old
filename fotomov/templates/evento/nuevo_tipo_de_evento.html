{% extends 'tabla.html' %}
{% load bootstrap %}
{% block css %}
<link href="{{ STATIC_URL }}/css/smoothness/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">
{% endblock %}
{% block titulo %}
Agregar tipo de evento
{% endblock %}
{% block seccion-contenido %}

<form method="POST">{% csrf_token %}
    <div class="row">
        <div class="col-md-5">{{ formulario.nombre | bootstrap }}
                <div class="col-md-5 hidden-xs hidden-sm"></div>
        </div>
        <div class="col-md-7">
            <table class="table table-striped table-bordered table-hover">
                <thead><th>Tipos de eventos</th></thead>
                {% for evento in eventos %}
                <tr id="{{ evento.id }}"><td>{{ evento.nombre }}  <a class="btn btn-xs btn-danger" onclick="eliminarTipoEvento({{ evento.id }})">Eliminar</a></td></tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <div class="col-md-12">
        <hr>
        <h3>Tareas predefinidas por evento</h3>
        <table class="table table-striped table-bordered table-hover">
            <thead><th>Descripcion</th><th>Staff</th><th>Usuario</th><th>Dias</th><th>Prelaciones</th></thead>
            <tbody name="0" id="tabla-tareas">
            </tbody>
        </table>
        <input type="hidden" name="tareas" id="toDoList" value="1">
    </div>
    <div class="text-right">
        <a class="btn btn-danger" onclick="eliminarTarea()"><span class="glyphicon glyphicon-minus"></span> Eliminar tarea</a> <a onclick="agregarTarea()" class="btn btn-success"><span class="glyphicon glyphicon-plus"></span> Agregar tarea</a>
    </div>
    <div class="col-md-12">
        <input type='submit' class="btn btn-default btn-primary" value='Ingresar'/>
    </div>
</form>
{% endblock %}
{% block js %}
<script type="text/javascript">

function eliminarTipoEvento(iden){

    $(".spinner").spinner();

}

function eliminarTarea(){

    var iden = parseInt(document.getElementById('tabla-tareas').getAttribute('name'));

    if(iden!=1){
        document.getElementById(iden).parentNode.removeChild(document.getElementById(iden));
    }else{
        document.getElementById('tabla-tareas').innerHTML = "";
    }

    iden--;
    document.getElementById('tabla-tareas').setAttribute('name',iden)
    document.getElementById('toDoList').setAttribute('value',iden);
}

function agregarTarea(){

    var iden = parseInt(document.getElementById('tabla-tareas').getAttribute('name'));
    iden++;
    document.getElementById('tabla-tareas').setAttribute('name',iden);

    document.getElementById('tabla-tareas').innerHTML += "<tr id="+iden+"><td><input type='text' name='desc-"+iden+"' placeholder='Descripcion...'></td><td><select name='select-staff' onchange=cargarUsuarios() ><option>---------</option>{% for staf in staff %}<option value='{{ staf.id }}'>{{ staf.nombre }}</option>{% endfor %}</select></td><td><select name='usu-"+iden+"' ><option>---------</option></select></td><td><input name='dias-"+iden+"' id='dias-"+iden+"' class='spinner'></td><td><input type='checkbox'></td></tr>";
    
    document.getElementById('toDoList').setAttribute('value',iden);

}

</script>
{% endblock %}